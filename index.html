<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Transponder by xpdr</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Transponder</h1>
        <p>Transponder is a opinionated javascript library for assisting in working with front end heavy rails app.</p>

        <p class="view"><a href="https://github.com/xpdr/transponder">View the Project on GitHub <small>xpdr/transponder</small></a></p>


        <ul>
          <li><a href="https://github.com/xpdr/transponder/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/xpdr/transponder/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/xpdr/transponder">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><img src="http://transponder.s3-ap-northeast-1.amazonaws.com/transponder-banner.png" alt="Transponder Banner"></p>

<p>Transponder is a opinionated library for assisting in working with front end heavy rails app.</p>

<p>8kb uncompressed / 2kb minified &amp; compressed (gzip) (client side library)</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>Add this line to your application's Gemfile:</p>

<pre><code>gem 'transponder'
</code></pre>

<p>And then execute:</p>

<pre><code>$ bundle
</code></pre>

<p>Or install it yourself as:</p>

<pre><code>$ gem install transponder
</code></pre>

<h2>
<a name="generate-a-basic-module" class="anchor" href="#generate-a-basic-module"><span class="octicon octicon-link"></span></a>Generate a basic Module</h2>

<p>A transponder module provides some basic structure for your javascript code</p>

<pre><code>rails g transponder:install application
</code></pre>

<p>This will generate a transponder 'module' in your <code>app/assets/javascripts</code> folder by the name of 'application', you can change the <code>application</code> to something else, but we recommend sticking with defaults until you understand more about transponder.</p>

<h2>
<a name="generate-a-presenter" class="anchor" href="#generate-a-presenter"><span class="octicon octicon-link"></span></a>Generate a Presenter</h2>

<p>Presenters is perhaps one of the most important thing about Transponder, it allows you to use your server side templates in your client side code, cleanly and allows better reuseability of code.</p>

<pre><code>rails g transponder:presenter contacts
</code></pre>

<p>Running this command will generate a presenter in your Transponder module <code>application/presenters</code> with the name <code>contacts_presenter.coffee</code></p>

<h2>
<a name="how-is-this-better-than-rails-ujs" class="anchor" href="#how-is-this-better-than-rails-ujs"><span class="octicon octicon-link"></span></a>How is this better than Rails UJS?</h2>

<p>Typically with Rails UJS you would create a view with something like this </p>

<p>Lets say you have a basic contacts_controller.rb</p>

<div class="highlight highlight-ruby"><pre><span class="k">class</span> <span class="nc">ContactsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">respond_to</span> <span class="ss">:json</span><span class="p">,</span> <span class="ss">:html</span><span class="p">,</span> <span class="ss">:js</span>

  <span class="k">def</span> <span class="nf">index</span>
    <span class="vi">@contacts</span> <span class="o">=</span> <span class="no">Contact</span><span class="o">.</span><span class="n">all</span>
    <span class="n">respond_with</span> <span class="vi">@contacts</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>

<p>In your <code>index.js.erb</code> you would then have something like this </p>

<div class="highlight highlight-js"><pre><span class="nx">$</span><span class="p">(</span><span class="s1">'#contacts'</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s2">"&lt;%= j render @contacts %&gt;"</span><span class="p">);</span>
</pre></div>

<p>This Javascript code is evaled in the browser and content of the node with the id <code>#contacts</code> gets replaced with server side template that came from <code>&lt;%= j render @contacts %&gt;</code> This is fine however it has a few problems. First of all if you use coffeescript it has to be compiled in real time as its responding which adds to your response time. Secondly if you want to do more complex things in your response things can get very messy. Code reuse isn't that great either.</p>

<p>With Transponder you have a consistent way of working with your server side template. Lets take a look at the difference</p>

<p>In your <code>index.js.erb</code> transponder version would look something like this.</p>

<div class="highlight highlight-js"><pre><span class="p">[</span><span class="s2">"#contacts"</span><span class="p">,</span> <span class="s2">"&lt;%= xms_event %&gt;"</span><span class="p">,</span> <span class="s2">"&lt;%= j render @contacts %&gt;"</span><span class="p">]</span>
</pre></div>

<p>Your server side response code using transponder will mostly likely look something like this. There is consistency to it. The first element is the DOM node you want to manipulate, the second element is what will allow the client side Transponder code to know which Presenter is responsible for this response and lastly we have the server side generated content.</p>

<h3>
<a name="so-what-happens-once-this-response-gets-to-the-client" class="anchor" href="#so-what-happens-once-this-response-gets-to-the-client"><span class="octicon octicon-link"></span></a>So what happens once this response gets to the client</h3>

<p>Well in our presenter we would do something like this </p>

<div class="highlight highlight-coffee"><pre><span class="k">class</span> <span class="nx">Application</span><span class="p">.</span><span class="nx">Presenters</span><span class="p">.</span><span class="nx">ContactsPresenter</span> <span class="k">extends</span> <span class="nx">Transponder</span><span class="p">.</span><span class="nx">Presenter</span>
  <span class="nv">presenterName: </span><span class="s">'contacts'</span>
  <span class="nv">module: </span><span class="s">'application'</span>

  <span class="nv">index: </span><span class="nf">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">@element</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">@response</span><span class="p">)</span>
    <span class="c1"># ... do more stuff ...</span>
</pre></div>

<p>The first 3 lines of code are generated by the presenter generator you were just using before the only line of code you should pay attention to here is the last 2. Basically the <code>@element</code> is the dom element you specified in <code>index.js.erb</code> and the <code>@response</code> is the content that was rendered by the server.</p>

<p>In the presenter you can do pretty much anything you want to your response before it gets output to the DOM. This gives a nice structure and consistency to the whole pattern. It allows you to mix server side templates with full client side programmability.</p>

<p>Testing is also much easier as now you've shifted the responsibility of the client side behavior to the client. We have more documentation coming on how to test your presenters.</p>

<h2>
<a name="services" class="anchor" href="#services"><span class="octicon octicon-link"></span></a>Services</h2>

<p>Services are meant to be an easy way to manage functionality of a widget on a page. What does this mean? </p>

<p>Generally we will have elements on the page that do more than just display information, they have to listen to some even like a mouse click or a tap and then act on that. They may have 1 simple functionality or multiple functions Services are a way to manage that. </p>

<p>Services are designed to be idempotent. You can run a service on a page repeatedly and it will not apply to the widgets that already have the same service applied. This can be very useful when working with pages that use pjax / turbolinks / single page apps etc...</p>

<h3>
<a name="service-generator" class="anchor" href="#service-generator"><span class="octicon octicon-link"></span></a>Service Generator</h3>

<p>To generate a service simply type</p>

<pre><code>rails g transponder:service contacts_search
</code></pre>

<p>In our <code>initializers/manifest.coffee</code> file we have something like this </p>

<div class="highlight highlight-coffee"><pre><span class="nv">Application.services_manifest = </span><span class="nf">-&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="s">'body'</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">'application:services:contacts_search'</span>
</pre></div>

<p>Basically we want to trigger this service on the page. Since we're using 'body' as the element the service will run on every page. If we apply a class to the html <code>&lt;body&gt;</code> tag to something like this in our application layout file <code>&lt;body class="&lt;%= controller_name %&gt; &lt;%= action_name %&gt;"</code> we can trigger specific services on specific pages.</p>

<p>For example if we're on the controller index page and we want to trigger the contacts search only when we're on that page we can do something like this</p>

<div class="highlight highlight-coffee"><pre><span class="nv">Application.services_manifest = </span><span class="nf">-&gt;</span>
  <span class="nx">$</span><span class="p">(</span><span class="s">'body.contacts.index'</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">'application:services:contacts_search'</span>
</pre></div>

<p>This gives us very fine grained control as to which services should run on which pages.</p>

<p>We have this in our erb some where on our page</p>

<div class="highlight highlight-html"><pre><span class="err">&lt;</span>%= form_tag contacts_path, class: 'navbar-form navbar-left contacts_search', remote: true do %&gt;
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">'form-group'</span><span class="nt">&gt;</span>
    <span class="err">&lt;</span>%= text_field_tag :query, nil,class: 'form-control', placeholder: "Search for someone", id: 'search-field' %&gt;
  <span class="nt">&lt;/div&gt;</span>
<span class="err">&lt;</span>% end %&gt;
</pre></div>

<p>which renders down to </p>

<div class="highlight highlight-html"><pre><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/contacts"</span> <span class="na">class=</span><span class="s">"navbar-form navbar-left contacts_search contacts_search_active"</span> <span class="na">data-remote=</span><span class="s">"true"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;&lt;div</span> <span class="na">style=</span><span class="s">"margin:0;padding:0;display:inline"</span><span class="nt">&gt;&lt;input</span> <span class="na">name=</span><span class="s">"utf8"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"✓"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"form-group"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"form-control"</span> <span class="na">id=</span><span class="s">"search-field"</span> <span class="na">name=</span><span class="s">"query"</span> <span class="na">placeholder=</span><span class="s">"Search for someone"</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div>

<p>The service will detect the element on the page with the matching class to the <code>serviceName:</code> and apply the behavior to those elements.</p>

<div class="highlight highlight-coffee"><pre><span class="k">class</span> <span class="nx">Application</span><span class="p">.</span><span class="nx">Services</span><span class="p">.</span><span class="nx">ContactsSearch</span> <span class="k">extends</span> <span class="nx">Transponder</span><span class="p">.</span><span class="nx">Service</span>
  <span class="nv">serviceName: </span><span class="s">'contacts_search'</span>
  <span class="nv">module: </span><span class="s">'application'</span>

  <span class="nv">init: </span><span class="nf">-&gt;</span>
    <span class="nx">@element</span><span class="p">.</span><span class="nx">on</span> <span class="s">'keyup'</span><span class="p">,</span> <span class="s">"</span><span class="err">#</span><span class="s">search-field"</span><span class="p">,</span> <span class="nx">@submitSearch</span>

  <span class="nv">search: </span><span class="nx">_</span><span class="p">.</span><span class="nx">debounce</span> <span class="p">(</span> <span class="nf">(e) -&gt;</span> 
    <span class="nv">field = </span><span class="nx">@element</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">'#search-field'</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span> 
      <span class="nv">url: </span><span class="nx">@element</span><span class="p">.</span><span class="nx">prop</span><span class="p">(</span><span class="s">'action'</span><span class="p">)</span>
      <span class="nv">dataType: </span><span class="s">'script'</span>
      <span class="nv">data: </span>
        <span class="nv">query: </span><span class="nx">field</span><span class="p">.</span><span class="nx">val</span><span class="p">()</span>
  <span class="p">),</span> <span class="mi">600</span>

  <span class="nv">submitSearch: </span><span class="nf">(field) =&gt;</span>
    <span class="nx">@search</span><span class="p">(</span><span class="nx">field</span><span class="p">)</span>

  <span class="nv">serve: </span><span class="nf">-&gt;</span>
    <span class="nx">@init</span><span class="p">()</span>
</pre></div>

<h2>
<a name="example-app" class="anchor" href="#example-app"><span class="octicon octicon-link"></span></a>Example App</h2>

<p>The code above is taken from the example app <a href="http://kontax.herokuapp.com">Kontax</a></p>

<p>You can review the Kontax app for a full picture of how all the pieces fit together.</p>

<ul>
<li><a href="http://kontax.herokuapp.com">kontax on heroku</a></li>
<li><a href="http://github.com/xpdr/kontax">kontax on github</a></li>
</ul><p>Kontax is an example app for showcasing what Transponder is capable of doing. The larger and more complex an app becomes the more transponder shines. Especially if you want to build apps that need real time stuff.</p>

<h2>
<a name="todo---whats-coming" class="anchor" href="#todo---whats-coming"><span class="octicon octicon-link"></span></a>TODO - Whats Coming</h2>

<ul>
<li>Add Documentation</li>
<li>Video Screencasts</li>
<li>Add more features to Kontax</li>
<li>More documentation on Services</li>
</ul><h2>
<a name="contributing" class="anchor" href="#contributing"><span class="octicon octicon-link"></span></a>Contributing</h2>

<ol>
<li>Fork it</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create new Pull Request</li>
</ol><h2>
<a name="credits" class="anchor" href="#credits"><span class="octicon octicon-link"></span></a>Credits</h2>

<p>Gem developed by <a href="http://github.com/zacksiri">Zack Siri</a> of <a href="http://www.artellectual.com">Artellectual</a></p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/xpdr">xpdr</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-46213366-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>